dataAc <- Data_set_A %>%
filter(condition=="control") #new dataframe ('dataAc') to see how many people are in the control group
library(tidyverse)
library(ggplot2) #required for the graph in the end
library(readxl)
Data_set_A <- read_excel("Data set A.xlsx")
#represents responses to a survey about how far people live from work.
Data_set_B <- read_excel("Data set B.xlsx")
#from the transportation department, indicates if a person's bus pass was used.
dataAc <- Data_set_A %>%
filter(condition=="control") #new dataframe ('dataAc') to see how many people are in the control group
dataAi <- Data_set_A %>%
filter(condition=="incentive") #new dataframe ('dataAi') to see how many people are in the incentive group
dataBrb <- Data_set_B %>%
filter(rode_bus=="1.0") #new dataframe ('dataAc') to see how many people rode the bus
colnames(Data_set_A) <- c('identifier','treatment','morethan10miles')
#rename the last to columns -- 'condition' to 'treatment' -- and -- distance_to_work to 'morethan10miles'.
Data_set_A$morethan10miles<- ifelse(Data_set_A$morethan10miles=="<10miles",0,1)
# 0 = No
# 1 = Yes
Data_set_A %>%
filter(morethan10miles=="1") #filter for more than 10 miles
Data_set_A %>%
filter(morethan10miles=="0") #filter for more than 10 miles
datamerge <- left_join(Data_set_A, Data_set_B, by="identifier") %>%
mutate_all(~replace(., is.na(.), 0)) %>%
mutate(rode_bus = case_when(rode_bus == "expired" ~ 1, TRUE ~ as.numeric(rode_bus)))
datamerge$treatment<- ifelse(datamerge$treatment=="incentive",0,1)
# 0 = No
# 1 = Yes
lm=lm(rode_bus ~ treatment + morethan10miles, data = datamerge)
summary(lm)
datamerge %>% group_by(treatment) %>% summarise(mean = mean(rode_bus))
summary(glm(rode_bus ~ factor(treatment) + factor(morethan10miles), family = "binomial", data = datamerge))
ggplot(radial,aes(y=NTAV,x=age))+geom_point()+geom_smooth(method="lm")
library(tidyverse)
library(ggplot2) #required for the graph in the end
library(readxl)
Data_set_A <- read_excel("Data set A.xlsx")
#represents responses to a survey about how far people live from work.
Data_set_B <- read_excel("Data set B.xlsx")
#from the transportation department, indicates if a person's bus pass was used.
colnames(Data_set_A) <- c('identifier','treatment','morethan10miles')
#rename the last to columns -- 'condition' to 'treatment' -- and -- distance_to_work to 'morethan10miles'.
Data_set_A$morethan10miles<- ifelse(Data_set_A$morethan10miles=="<10miles",0,1)
# 0 = No
# 1 = Yes
Data_set_A %>%
filter(morethan10miles=="1") #filter for more than 10 miles
Data_set_A %>%
filter(morethan10miles=="0") #filter for more than 10 miles
datamerge <- left_join(Data_set_A, Data_set_B, by="identifier") %>%
mutate_all(~replace(., is.na(.), 0)) %>%
mutate(rode_bus = case_when(rode_bus == "expired" ~ 1, TRUE ~ as.numeric(rode_bus)))
datamerge$treatment<- ifelse(datamerge$treatment=="incentive",0,1)
# 0 = No
# 1 = Yes
lm=lm(rode_bus ~ treatment + morethan10miles, data = datamerge)
summary(lm)
datamerge %>% group_by(treatment) %>% summarise(mean = mean(rode_bus))
summary(glm(rode_bus ~ factor(treatment) + factor(morethan10miles), family = "binomial", data = datamerge))
dataAc <- Data_set_A %>%
filter(condition=="control") #new dataframe ('dataAc') to see how many people are in the control group
dataAc <- Data_set_A %>%
filter(treatment=="control") #new dataframe ('dataAc') to see how many people are in the control group
dataAi <- Data_set_A %>%
filter(treatment=="incentive") #new dataframe ('dataAi') to see how many people are in the incentive group
dataBrb <- Data_set_B %>%
filter(rode_bus=="1.0") #new dataframe ('dataAc') to see how many people rode the bus
View(dataAi)
View(dataBrb)
datamerge %>% group_by(treatment) %>% summarise(mean = mean(rode_bus))
summary(glm(rode_bus ~ factor(treatment) + factor(morethan10miles), family = "binomial", data = datamerge))
table(rode_bus, treatment)
datamerged$table(rode_bus, treatment)
table(datamerged$rode_bus, datamerged$treatment)
datamerged
table(datamerge$rode_bus, datamerge$treatment)
table(datamerge$rode_bus, datamerge$treatment)
library(tidyverse)
library(readxl)
library(ggpubr)
#logodds <-
c( control = -0.28466,  treatment = -0.28466-0.49827, controlmiless = -0.28466 +  0.01323 , treatmentmiless = -0.28466 +  0.01323-0.49827 )
exp(logodds)/(1+ exp(logodds))
#glmmodel <-
glm(rode_bus~factor(condition) + factor(lessthan10mi), family = "binomial", data = merged)
glmmodel <-  glm(rode_bus~factor(condition) + factor(lessthan10mi), family = "binomial", data = merged)
library(tidyverse)
library(readxl)
library(ggpubr)
Data_set_A <- read_excel("Data set A.xlsx")
glmmodel <-  glm(rode_bus~factor(condition) + factor(lessthan10mi), family = "binomial", data = merged)
merged <-  left_join(Data_set_A, Data_set_B, by="identifier") %>%
mutate_all(~replace(., is.na(.), 0)) %>%
mutate(rode_bus = case_when(rode_bus == "expired" ~ 1, TRUE ~ as.numeric(rode_bus)))
library(tidyverse)
library(readxl)
library(ggpubr)
Data_set_A <- read_excel("Data set A.xlsx")
merged$condition<- ifelse(merged$condition=="incentive",0,1)
library(tidyverse)
library(ggplot2) #required for the graph in the end
library(readxl)
Data_set_A <- read_excel("Data set A.xlsx")
#represents responses to a survey about how far people live from work.
Data_set_B <- read_excel("Data set B.xlsx")
#from the transportation department, indicates if a person's bus pass was used.
dataAc <- Data_set_A %>%
filter(condition=="control") #new dataframe ('dataAc') to see how many people are in the control group
dataAi <- Data_set_A %>%
filter(condition=="incentive") #new dataframe ('dataAi') to see how many people are in the incentive group
dataBrb <- Data_set_B %>%
filter(rode_bus=="1.0") #new dataframe ('dataAc') to see how many people rode the bus
colnames(Data_set_A) <- c('identifier','treatment','morethan10miles')
#rename the last to columns -- 'condition' to 'treatment' -- and -- distance_to_work to 'morethan10miles'.
Data_set_A$morethan10miles<- ifelse(Data_set_A$morethan10miles=="<10miles",0,1)
# 0 = No
# 1 = Yes
Data_set_A %>%
filter(morethan10miles=="1") #filter for more than 10 miles
Data_set_A %>%
filter(morethan10miles=="0") #filter for more than 10 miles
datamerge <- left_join(Data_set_A, Data_set_B, by="identifier") %>%
mutate_all(~replace(., is.na(.), 0)) %>%
mutate(rode_bus = case_when(rode_bus == "expired" ~ 1, TRUE ~ as.numeric(rode_bus)))
datamerge$treatment<- ifelse(datamerge$treatment=="incentive",0,1)
# 0 = No
# 1 = Yes
datamerge %>% group_by(treatment) %>% summarise(mean = mean(rode_bus))
summary(glm(rode_bus ~ factor(treatment) + factor(morethan10miles), family = "binomial", data = datamerge))
table(datamerge$rode_bus, datamerge$treatment)
ggplot(radial,aes(y=NTAV,x=age))+geom_point()+geom_smooth(method="lm")
library(tidyverse)
library(ggplot2) #required for the graph in the end
library(readxl)
Data_set_A <- read_excel("Data set A.xlsx")
#represents responses to a survey about how far people live from work.
Data_set_B <- read_excel("Data set B.xlsx")
#from the transportation department, indicates if a person's bus pass was used.
dataAc <- Data_set_A %>%
filter(condition=="control") #new dataframe ('dataAc') to see how many people are in the control group
dataAi <- Data_set_A %>%
filter(condition=="incentive") #new dataframe ('dataAi') to see how many people are in the incentive group
dataBrb <- Data_set_B %>%
filter(rode_bus=="1.0") #new dataframe ('dataAc') to see how many people rode the bus
colnames(Data_set_A) <- c('identifier','treatment','morethan10miles')
#rename the last to columns -- 'condition' to 'treatment' -- and -- distance_to_work to 'morethan10miles'.
Data_set_A$morethan10miles<- ifelse(Data_set_A$morethan10miles=="<10miles",0,1)
# 0 = No
# 1 = Yes
Data_set_A %>%
filter(morethan10miles=="1") #filter for more than 10 miles
Data_set_A %>%
filter(morethan10miles=="0") #filter for more than 10 miles
datamerge <- left_join(Data_set_A, Data_set_B, by="identifier") %>%
mutate_all(~replace(., is.na(.), 0)) %>%
mutate(rode_bus = case_when(rode_bus == "expired" ~ 1, TRUE ~ as.numeric(rode_bus)))
datamerge$treatment<- ifelse(datamerge$treatment=="incentive",0,1)
# 0 = No
# 1 = Yes
datamerge %>% group_by(treatment) %>% summarise(mean = mean(rode_bus))
summary(glm(rode_bus ~ factor(treatment) + factor(morethan10miles), family = "binomial", data = datamerge))
table(datamerge$rode_bus, datamerge$treatment)
ggplot(radial,aes(y=NTAV,x=age))+geom_point()+geom_smooth(method="lm")
View(datamerge)
datamerge <- left_join(Data_set_A, Data_set_B, by="identifier") %>%
mutate_all(~replace(., is.na(.), 0)) %>%
mutate(rode_bus = case_when(rode_bus == "expired" ~ 1, TRUE ~ as.numeric(rode_bus)))
datamerge$treatment<- ifelse(datamerge$treatment=="incentive",0,1)
# 0 = No
# 1 = Yes
datamerge %>% group_by(treatment) %>% summarise(mean = mean(rode_bus))
logodds <-  c( control = -0.27143,  treatment = -0.27143-0.49827, controlmiless = -0.27143 +  0.01323 , treatmentmiless = --0.27143 +  0.01323-0.49827 )
exp(logodds)/(1+ exp(logodds))
logodds <-  c( control = -0.27143,  treatment = -0.27143-0.49827, controlmiles = -0.27143 +  0.01323 , treatmentmiles = --0.27143 +  0.01323-0.49827 )
exp(logodds)/(1+ exp(logodds))
data.plot <-  data.frame(prob = datamerge$rode_bus/1003,
condition = datamerge$treatmennt,
lessthan10mi = datamerge$morethan10miles,
fit = predict(glmmodel, datamerge))
logmodel <- summary(glm(rode_bus ~ factor(treatment) + factor(morethan10miles), family = "binomial", data = datamerge))
View(logmodel)
data.plot <-  data.frame(prob = datamerge$rode_bus/1003,
condition = datamerge$treatmennt,
lessthan10mi = datamerge$morethan10miles,
fit = predict(logmodel, datamerge))
data.plot <-  data.frame(prob = datamerge$rode_bus/1003,
condition = datamerge$treatmennt,
lessthan10mi = datamerge$morethan10miles,
fit = predict(logmodel, datamerge))
summary(glm(rode_bus ~ factor(treatment) + factor(morethan10miles), family = "binomial", data = datamerge))
rm(logodds)
glmmodel <-  glm(rode_bus~factor(treatment) + factor(morethan10miles), family = "binomial", data = datamerge)
summary_glm<-summary(glmmodel)
summary_glm
data.plot <-  data.frame(prob = datamerge$rode_bus/1003,
condition = datamerge$treatmennt,
lessthan10mi = datamerge$morethan10miles,
fit = predict(glmmodel, datamerge))
data.plot <-  data.frame(prob = datamerge$rode_bus/1003,
condition = datamerge$treatment,
lessthan10mi = datamerge$morethan10miles,
fit = predict(glmmodel, datamerge))
data.plot$fit_prob <- exp(plot.dat$fit)/(1+exp(plot.dat$fit))
data.plot <-  data.frame(prob = datamerge$rode_bus/1003,
condition = datamerge$treatment,
lessthan10mi = datamerge$morethan10miles,
fit = predict(glmmodel, datamerge))
data.plot$fit_prob <- exp(data.plot$fit)/(1+exp(data.plot$fit))
data.plot <-  data.frame(prob = datamerge$rode_bus/1003,
condition = datamerge$treatment,
lessthan10mi = datamerge$morethan10miles,
fit = predict(glmmodel, datamerge))
data.plot$fit_prob <- exp(data.plot$fit)/(1+exp(data.plot$fit))
rm(merged)
View(data.plot)
data.plot <-  data.frame(prob = datamerge$rode_bus/1003,
condition = datamerge$treatment,
lessthan10mi = datamerge$morethan10miles,
fit = predict(glmmodel, datamerge))
#we insert the
data.plot$fit_prob <- exp(data.plot$fit)/(1+exp(data.plot$fit))
ggplot(plot.dat, aes(x=treatment, y=fit_prob, group= morethan10miles, fill= factor(morethan10miles))) +
geom_point() +
geom_col(position = "dodge")
library(tidyverse)
library(ggplot2) #required for the graph in the end
library(readxl)
Data_set_A <- read_excel("Data set A.xlsx")
#represents responses to a survey about how far people live from work.
Data_set_B <- read_excel("Data set B.xlsx")
#from the transportation department, indicates if a person's bus pass was used.
dataAc <- Data_set_A %>%
filter(condition=="control") #new dataframe ('dataAc') to see how many people are in the control group
dataAi <- Data_set_A %>%
filter(condition=="incentive") #new dataframe ('dataAi') to see how many people are in the incentive group
dataBrb <- Data_set_B %>%
filter(rode_bus=="1.0") #new dataframe ('dataAc') to see how many people rode the bus
colnames(Data_set_A) <- c('identifier','treatment','morethan10miles')
#rename the last to columns -- 'condition' to 'treatment' -- and -- distance_to_work to 'morethan10miles'.
Data_set_A$morethan10miles<- ifelse(Data_set_A$morethan10miles=="<10miles",0,1)
# 0 = No
# 1 = Yes
Data_set_A %>%
filter(morethan10miles=="1") #filter for more than 10 miles
Data_set_A %>%
filter(morethan10miles=="0") #filter for more than 10 miles
datamerge <- left_join(Data_set_A, Data_set_B, by="identifier") %>%
mutate_all(~replace(., is.na(.), 0)) %>%
mutate(rode_bus = case_when(rode_bus == "expired" ~ 1, TRUE ~ as.numeric(rode_bus)))
datamerge$treatment<- ifelse(datamerge$treatment=="incentive",0,1)
# 0 = No
# 1 = Yes
datamerge %>% group_by(treatment) %>% summarise(mean = mean(rode_bus))
glmmodel <-  glm(rode_bus~factor(treatment) + factor(morethan10miles), family = "binomial", data = datamerge)
summary_glm<-summary(glmmodel)
summary_glm
logodds <-  c( control = -0.27143,  treatment = -0.27143-0.49827, controlmiles = -0.27143 +  0.01323 , treatmentmiles = --0.27143 +  0.01323-0.49827 )
exp(logodds)/(1+ exp(logodds))
data.plot <-  data.frame(prob = datamerge$rode_bus/1003,
condition = datamerge$treatment,
lessthan10mi = datamerge$morethan10miles,
fit = predict(glmmodel, datamerge))
#we insert the
data.plot$fit_prob <- exp(data.plot$fit)/(1+exp(data.plot$fit))
ggplot(plot.dat, aes(x=treatment, y=fit_prob, group= morethan10miles, fill= factor(morethan10miles))) +
geom_point() +
geom_col(position = "dodge")
ggplot(radial,aes(y=NTAV,x=age))+geom_point()+geom_smooth(method="lm")
ggplot(plot.dat, aes(x=treatment, y=fit_prob, group= morethan10miles, fill= factor(morethan10miles))) +
geom_point() +
geom_col(position = "dodge")
ggplot(data.plot, aes(x=treatment, y=fit_prob, group= morethan10miles, fill= factor(morethan10miles))) +
geom_point() +
geom_col(position = "dodge")
library(tidyverse)
library(readxl)
library(ggpubr)
merged$condition<- ifelse(merged$condition=="incentive",0,1)
library(tidyverse)
library(ggplot2) #required for the graph in the end
library(readxl)
Data_set_A <- read_excel("Data set A.xlsx")
#represents responses to a survey about how far people live from work.
Data_set_B <- read_excel("Data set B.xlsx")
#from the transportation department, indicates if a person's bus pass was used.
dataAc <- Data_set_A %>%
filter(condition=="control") #new dataframe ('dataAc') to see how many people are in the control group
dataAi <- Data_set_A %>%
filter(condition=="incentive") #new dataframe ('dataAi') to see how many people are in the incentive group
dataBrb <- Data_set_B %>%
filter(rode_bus=="1.0") #new dataframe ('dataAc') to see how many people rode the bus
colnames(Data_set_A) <- c('identifier','treatment','morethan10miles')
#rename the last to columns -- 'condition' to 'treatment' -- and -- distance_to_work to 'morethan10miles'.
Data_set_A$morethan10miles<- ifelse(Data_set_A$morethan10miles=="<10miles",0,1)
# 0 = No
# 1 = Yes
Data_set_A %>%
filter(morethan10miles=="1") #filter for more than 10 miles
Data_set_A %>%
filter(morethan10miles=="0") #filter for more than 10 miles
datamerge <- left_join(Data_set_A, Data_set_B, by="identifier") %>%
mutate_all(~replace(., is.na(.), 0)) %>%
mutate(rode_bus = case_when(rode_bus == "expired" ~ 1, TRUE ~ as.numeric(rode_bus)))
datamerge$treatment<- ifelse(datamerge$treatment=="incentive",0,1)
# 0 = No
# 1 = Yes
datamerge %>% group_by(treatment) %>% summarise(mean = mean(rode_bus))
glmmodel <-  glm(rode_bus~factor(treatment) + factor(morethan10miles), family = "binomial", data = datamerge)
summary_glm<-summary(glmmodel)
summary_glm
logodds <-  c( control = -0.27143,  treatment = -0.27143-0.49827, controlmiles = -0.27143 +  0.01323 , treatmentmiles = --0.27143 +  0.01323-0.49827 )
exp(logodds)/(1+ exp(logodds))
data.plot <-  data.frame(prob = datamerge$rode_bus/1003,
condition = datamerge$treatment,
lessthan10mi = datamerge$morethan10miles,
fit = predict(glmmodel, datamerge))
#we insert the
data.plot$fit_prob <- exp(data.plot$fit)/(1+exp(data.plot$fit))
ggplot(data.plot, aes(x=treatment, y=fit_prob, group= morethan10miles, fill= factor(morethan10miles))) +
geom_point() +
geom_col(position = "dodge")
data.plot <-  data.frame(prob = datamerge$rode_bus/1003,
treatment = datamerge$treatment,
morethan10miles = datamerge$morethan10miles,
fit = predict(glmmodel, datamerge))
#we insert the
data.plot$fit_prob <- exp(data.plot$fit)/(1+exp(data.plot$fit))
View(data.plot)
library(tidyverse)
library(ggplot2) #required for the graph in the end
library(readxl)
Data_set_A <- read_excel("Data set A.xlsx")
#represents responses to a survey about how far people live from work.
Data_set_B <- read_excel("Data set B.xlsx")
#from the transportation department, indicates if a person's bus pass was used.
dataAc <- Data_set_A %>%
filter(condition=="control") #new dataframe ('dataAc') to see how many people are in the control group
dataAi <- Data_set_A %>%
filter(condition=="incentive") #new dataframe ('dataAi') to see how many people are in the incentive group
dataBrb <- Data_set_B %>%
filter(rode_bus=="1.0") #new dataframe ('dataAc') to see how many people rode the bus
colnames(Data_set_A) <- c('identifier','treatment','morethan10miles')
#rename the last to columns -- 'condition' to 'treatment' -- and -- distance_to_work to 'morethan10miles'.
Data_set_A$morethan10miles<- ifelse(Data_set_A$morethan10miles=="<10miles",0,1)
# 0 = No
# 1 = Yes
Data_set_A %>%
filter(morethan10miles=="1") #filter for more than 10 miles
Data_set_A %>%
filter(morethan10miles=="0") #filter for more than 10 miles
datamerge <- left_join(Data_set_A, Data_set_B, by="identifier") %>%
mutate_all(~replace(., is.na(.), 0)) %>%
mutate(rode_bus = case_when(rode_bus == "expired" ~ 1, TRUE ~ as.numeric(rode_bus)))
datamerge$treatment<- ifelse(datamerge$treatment=="incentive",0,1)
# 0 = No
# 1 = Yes
datamerge %>% group_by(treatment) %>% summarise(mean = mean(rode_bus))
glmmodel <-  glm(rode_bus~factor(treatment) + factor(morethan10miles), family = "binomial", data = datamerge)
summary_glm<-summary(glmmodel)
summary_glm
logodds <- c( control = -0.27143,  treatment = -0.27143-0.49827, controlmiles = -0.27143 +  0.01323 , treatmentmiles = --0.27143 +  0.01323-0.49827 )
exp(logodds)/(1+ exp(logodds))
data.plot <-  data.frame(prob = datamerge$rode_bus/1003,
treatment = datamerge$treatment,
morethan10miles = datamerge$morethan10miles,
fit = predict(glmmodel, datamerge))
#we insert the
data.plot$fit_prob <- exp(data.plot$fit)/(1+exp(data.plot$fit))
ggplot(data.plot, aes(x=treatment, y=fit_prob, group= morethan10miles, fill= factor(morethan10miles))) +
geom_point() +
geom_col(position = "dodge")
library(ggplot2)
ggplot(plot.dat, aes(x=condition, y=fit_prob, group= lessthan10mi, fill= factor(lessthan10mi))) +
geom_point() +
geom_col(position = "dodge")
data.plot <-  data.frame(prob = datamerge$rode_bus/1003,
treatment = datamerge$treatment,
morethan10miles = datamerge$morethan10miles,
fit = predict(glmmodel, datamerge))
#we insert the
data.plot$fit_prob <- exp(data.plot$fit)/(1+exp(data.plot$fit))
data.plot <-  data.frame(prob = datamerge$rode_bus/1003,
treatment = datamerge$treatment,
morethan10miles = datamerge$morethan10miles,
fit = predict(glmmodel, datamerge))
#we insert the
data.plot$fit_prob <- exp(data.plot$fit)/(1+exp(data.plot$fit))
ggplot(data.plot, aes(x=treatment, y=fit_prob, group= morethan10miles, fill= factor(morethan10miles))) +
geom_point() +
geom_col(position = "dodge")
View(data.plot)
logodds <- c(control = -0.27143,  treatment = -0.27143-0.49827, controlmiles = -0.27143 +  0.01323 , treatmentmiles = --0.27143 +  0.01323-0.49827)
exp(logodds)/(1+ exp(logodds)) #we take the exponent of logg odds and devide it by the same number plus one.
data.plot <-  data.frame(prob = datamerge$rode_bus/1003,
treatment = datamerge$treatment,
morethan10miles = datamerge$morethan10miles,
fit = predict(glmmodel, datamerge)) #prediction for the logistic regression model
#we insert the
data.plot$fit_prob <- exp(data.plot$fit)/(1+exp(data.plot$fit))
View(data.plot)
view(data.plot)
View(data.plot)
data.plot <-  data.frame(prob = datamerge$rode_bus/1003,
treatment = datamerge$treatment,
morethan10miles = datamerge$morethan10miles,
fit = predict(glmmodel, datamerge)) #prediction for the logistic regression model
#we insert the
data.plot$fit_prob <- exp(data.plot$fit)/(1+exp(data.plot$fit))
view(data.plot$fit_prob)
View(data.plot)
data.plot <-  data.frame(prob = datamerge$rode_bus/1003,
treatment = datamerge$treatment,
morethan10miles = datamerge$morethan10miles,
fit = predict(glmmodel, datamerge)) #prediction for the logistic regression model
ggplot(data.plot, aes(x=treatment, y=fit_prob, group= morethan10miles, fill= factor(morethan10miles))) +
geom_point() +
geom_col(position = "dodge")
data.plot <-  data.frame(prob = datamerge$rode_bus/1003,
treatment = datamerge$treatment,
morethan10miles = datamerge$morethan10miles,
fit = predict(glmmodel, datamerge)) #prediction for the logistic regression model
#we insert the
data.plot$fit_prob <- exp(data.plot$fit)/(1+exp(data.plot$fit))
ggplot(data.plot, aes(x=treatment, y=fit_prob, group= morethan10miles, fill= factor(morethan10miles))) +
geom_point() +
geom_col(position = "dodge")
setwd("~/Desktop/522 R sessions-directory")
library(tidyverse)
library(ggplot2) #required for the graph in the end
library(readxl)
Data_set_A <- read_excel("Data set A.xlsx")
#represents responses to a survey about how far people live from work.
Data_set_B <- read_excel("Data set B.xlsx")
#from the transportation department, indicates if a person's bus pass was used.
dataAc <- Data_set_A %>%
filter(condition=="control") #new dataframe ('dataAc') to see how many people are in the control group
dataAi <- Data_set_A %>%
filter(condition=="incentive") #new dataframe ('dataAi') to see how many people are in the incentive group
dataBrb <- Data_set_B %>%
filter(rode_bus=="1.0") #new dataframe ('dataAc') to see how many people rode the bus
colnames(Data_set_A) <- c('identifier','treatment','morethan10miles')
#rename the last to columns -- 'condition' to 'treatment' -- and -- distance_to_work to 'morethan10miles'.
Data_set_A$morethan10miles<- ifelse(Data_set_A$morethan10miles=="<10miles",0,1)
# 0 = No
# 1 = Yes
Data_set_A %>%
filter(morethan10miles=="1") #filter for more than 10 miles
Data_set_A %>%
filter(morethan10miles=="0") #filter for more than 10 miles
datamerge <- left_join(Data_set_A, Data_set_B, by="identifier") %>%
mutate_all(~replace(., is.na(.), 0)) %>%
mutate(rode_bus = case_when(rode_bus == "expired" ~ 1, TRUE ~ as.numeric(rode_bus)))
datamerge$treatment<- ifelse(datamerge$treatment=="incentive",0,1)
# 0 = No
# 1 = Yes
glmmodel <-  glm(rode_bus~factor(treatment) + factor(morethan10miles), family = "binomial", data = datamerge)
summary_glm<-summary(glmmodel)
summary_glm
logodds <- c(control = -0.27143,  treatment = -0.27143-0.49827, controlmiles = -0.27143 +  0.01323 , treatmentmiles = --0.27143 +  0.01323-0.49827)
exp(logodds)/(1+ exp(logodds)) #we take the exponent of logg odds and devide it by the same number plus one.
data.plot <-  data.frame(prob = datamerge$rode_bus/1003,
treatment = datamerge$treatment,
morethan10miles = datamerge$morethan10miles,
fit = predict(glmmodel, datamerge)) #prediction for the logistic regression model
data.plot$fit_prob <- exp(data.plot$fit)/(1+exp(data.plot$fit))
ggplot(data.plot, aes(x=treatment, y=fit_prob, group= morethan10miles, fill= factor(morethan10miles))) +
geom_point() +
geom_col(position = "dodge")
setwd("~/Desktop/github/LoizosKo")
library(tidyverse)
library(ggplot2) #required for the graph in the end
library(readxl)
Data_set_A <- read_excel("Data set A.xlsx")
#represents responses to a survey about how far people live from work.
Data_set_B <- read_excel("Data set B.xlsx")
#from the transportation department, indicates if a person's bus pass was used.
dataAc <- Data_set_A %>%
filter(condition=="control") #new dataframe ('dataAc') to see how many people are in the control group
dataAi <- Data_set_A %>%
filter(condition=="incentive") #new dataframe ('dataAi') to see how many people are in the incentive group
dataBrb <- Data_set_B %>%
filter(rode_bus=="1.0") #new dataframe ('dataAc') to see how many people rode the bus
colnames(Data_set_A) <- c('identifier','treatment','morethan10miles')
#rename the last to columns -- 'condition' to 'treatment' -- and -- distance_to_work to 'morethan10miles'.
Data_set_A$morethan10miles<- ifelse(Data_set_A$morethan10miles=="<10miles",0,1)
# 0 = No
# 1 = Yes
Data_set_A %>%
filter(morethan10miles=="1") #filter for more than 10 miles
Data_set_A %>%
filter(morethan10miles=="0") #filter for more than 10 miles
datamerge <- left_join(Data_set_A, Data_set_B, by="identifier") %>%
mutate_all(~replace(., is.na(.), 0)) %>%
mutate(rode_bus = case_when(rode_bus == "expired" ~ 1, TRUE ~ as.numeric(rode_bus)))
datamerge$treatment<- ifelse(datamerge$treatment=="incentive",0,1)
# 0 = No
# 1 = Yes
glmmodel <-  glm(rode_bus~factor(treatment) + factor(morethan10miles), family = "binomial", data = datamerge)
summary_glm<-summary(glmmodel)
summary_glm
logodds <- c(control = -0.27143,  treatment = -0.27143-0.49827, controlmiles = -0.27143 +  0.01323 , treatmentmiles = --0.27143 +  0.01323-0.49827)
exp(logodds)/(1+ exp(logodds)) #we take the exponent of logg odds and devide it by the same number plus one.
data.plot <-  data.frame(prob = datamerge$rode_bus/1003,
treatment = datamerge$treatment,
morethan10miles = datamerge$morethan10miles,
fit = predict(glmmodel, datamerge)) #prediction for the logistic regression model
data.plot$fit_prob <- exp(data.plot$fit)/(1+exp(data.plot$fit))
ggplot(data.plot, aes(x=treatment, y=fit_prob, group= morethan10miles, fill= factor(morethan10miles))) +
geom_point() +
geom_col(position = "dodge")

mutate(count= case_when(answer == "Yes (bonus payment of $0.10)" ~ 1,
answer == "No (no bonus payment)" ~ 0))
pilpi <- countcol %>% select(-answer) %>% mutate(id = rep(1:133, each = 20)) %>%  pivot_wider(id_cols = c(id, Age, SC0, Risk, Gender), names_from = draw, values_from = count)
pi <- pilpi %>% pivot_longer(cols = starts_with("Outcome"), names_to= "draw", values_to = "answer") %>% group_by(id)
ti<- pi %>% mutate(summm=sum(answer))
tii<- pi %>% mutate(summm=sum(answer)) %>% separate(draw, into = c("rolsep", "rolnum"), sep = "e") %>% group_by(id)
# boxplot.stats(data$score)$out
#
# rr <- ti %>% separate(draw, into = c("rolsep", "rolnum"), sep = "e") %>% group_by(id, rolnum)
final <- ti %>%  pivot_wider(id_cols = c(id, Age, SC0, Risk, Gender, summm), names_from = draw, values_from = answer)
# finally <- tii %>%  pivot_wider(id_cols = c(id, Age, SC0, Risk, Gender, summm), names_from = rolnum, values_from = answer)
#
#   fin <- final %>% inner_join(ex22, by = "id")
ggplot(final, aes(summm)) + geom_histogram(bins = 21) + geom_rug()
ex2 <- exp21 %>%
mutate(condition = case_when(Control_Msg != "" ~ 1,
Norm_Pos_Msg != "" ~ 2,
Norm_Neg_Msg != "" ~ 3,
Emp_Neg_Msg != "" ~ 4,
Emp_Pos_Msg != "" ~ 5),
id = 1:133,
rolnum = 1:133)
ex22 <- ex2 %>% select(id, condition, rolnum)
fin <- final %>% inner_join(ex22, by = "id")
fin %>% group_by(Gender) %>% summarise(mean(summm))
# mutate(rrr, coun)
# fin %>% group_by(condition) %>% summarise(mean(summm))
i <- tii %>% select(-Gender, -Age, -SC0, -id, -Risk, -rolsep, -summm, -id)
i %>% filter(rolnum==1) %>% summary(answer)
i %>% filter(rolnum==2) %>% summary(answer)
i %>% filter(rolnum==3) %>% summary(answer)
i %>% filter(rolnum==4) %>% summary(answer)
i %>% filter(rolnum==5) %>% summary(answer)
i %>% filter(rolnum==6) %>% summary(answer)
i %>% filter(rolnum==7) %>% summary(answer)
i %>% filter(rolnum==8) %>% summary(answer)
i %>% filter(rolnum==9) %>% summary(answer)
i %>% filter(rolnum==10) %>% summary(answer)
i %>% filter(rolnum==11) %>% summary(answer)
i %>% filter(rolnum==12) %>% summary(answer)
i %>% filter(rolnum==13) %>% summary(answer)
i %>% filter(rolnum==14) %>% summary(answer)
i %>% filter(rolnum==15) %>% summary(answer)
i %>% filter(rolnum==16) %>% summary(answer)
i %>% filter(rolnum==17) %>% summary(answer)
i %>% filter(rolnum==18) %>% summary(answer)
i %>% filter(rolnum==19) %>% summary(answer)
i %>% filter(rolnum==20) %>% summary(answer)
fin %>% group_by(condition) %>% summarise(mean(summm))
# trial <- fin %>% select(-Gender, -Age, -SC0, -Risk, -Outcome1, -Outcome2, -Outcome3, -Outcome4, -Outcome5, -Outcome6, -Outcome7, -Outcome8, -Outcome9, -Outcome10, -Outcome11, -Outcome12, -Outcome13, -Outcome14, -Outcome15, -Outcome16, -Outcome17, -Outcome18, -Outcome19, -Outcome20, -rolnum) %>%
#   boxplot(trial)
#
# boxplot.stats(trial$summm)$out
boxplot(fin$summm,
ylab = "summm")
boxplot.stats(fin$summm)$out
out <- boxplot.stats(fin$summm)$out
out_ind <- which(fin$summm %in% c(out))
out_ind
# ggplot(fin) +
#   aes(x = summm) +
#   geom_histogram(bins = 21, fill = "#0c4c8a") +
#   theme_minimal()
desperate <- fin[-c(15, 25,48,57,89,98,121,130), ]
desperate %>% group_by(Gender) %>% summarise(mean(summm))
abcdefg <- tii[-c(15, 25,48,57,89,98,121,130), ]
i <- abcdefg %>% select(-Gender, -Age, -SC0, -id, -Risk, -summm, -rolsep, -id)
i %>% filter(rolnum==1) %>% summary(answer)
i %>% filter(rolnum==2) %>% summary(answer)
i %>% filter(rolnum==3) %>% summary(answer)
i %>% filter(rolnum==4) %>% summary(answer)
i %>% filter(rolnum==5) %>% summary(answer)
i %>% filter(rolnum==6) %>% summary(answer)
i %>% filter(rolnum==7) %>% summary(answer)
i %>% filter(rolnum==8) %>% summary(answer)
i %>% filter(rolnum==9) %>% summary(answer)
i %>% filter(rolnum==10) %>% summary(answer)
i %>% filter(rolnum==11) %>% summary(answer)
i %>% filter(rolnum==12) %>% summary(answer)
i %>% filter(rolnum==13) %>% summary(answer)
i %>% filter(rolnum==14) %>% summary(answer)
i %>% filter(rolnum==15) %>% summary(answer)
i %>% filter(rolnum==16) %>% summary(answer)
i %>% filter(rolnum==17) %>% summary(answer)
i %>% filter(rolnum==18) %>% summary(answer)
i %>% filter(rolnum==19) %>% summary(answer)
i %>% filter(rolnum==20) %>% summary(answer)
desperate %>% group_by(condition) %>% summarise(mean(summm))
ordered<- fin[order(fin$Age, decreasing = TRUE), ]
median(fin$Age)
orderedyoung <- ordered[-c(1:66), ]
orderedold <- ordered[-c(68:133), ]
boxplot(orderedold$Age,
ylab = "Age")
boxplot.stats(orderedold$Age)$out
out <- boxplot.stats(orderedold$Age)$out
out_ind <- which(orderedold$Age %in% c(out))
out_ind
boxplot(orderedyoung$Age,
ylab = "Age")
boxplot.stats(orderedyoung$Age)$out
out <- boxplot.stats(orderedyoung$Age)$out
out_ind <- which(orderedyoung$Age %in% c(out))
out_ind
oo <- orderedold[-c(1,2,3,4), ]
oy <- orderedyoung[-c(67), ]
oo%>% ggplot(aes(x= Age, y= summm)) + geom_point()
median(oo$summm)
mean(oo$summm)
oy%>% ggplot(aes(x= Age, y= summm)) + geom_point()
median(oy$summm)
mean(oy$summm)
library(readxl)
exp21 <- read_excel("experiment_2021C(1)copy.xlsx", col_names = FALSE,
skip = 2)
var_names <- read_excel("experiment_2021C(1)copy.xlsx", n_max = 1)
colnames(exp21) <- colnames(var_names)
rm(var_names)
columnss <- exp21 %>%
select(starts_with("Outcome"), "Age", "Risk", "Gender", "SC0")
datac <- columnss %>% mutate(score = SC0 *10)
datacool <- datac %>% select(-Outcome1, -Outcome2, -Outcome3, -Outcome4, -Outcome5, -Outcome6, -Outcome7, -Outcome8, -Outcome9, -Outcome10, -Outcome11, -Outcome12, -Outcome13, -Outcome14, -Outcome15, -Outcome16, -Outcome17, -Outcome18, -Outcome19, -Outcome20, -SC0)
dataex1<- datacool %>% select(-Risk, - Age)
options(scipen = 100)
datacool1 <- datacool %>% mutate(Gendering = case_when(Gender == "Male" ~ "1",
Gender== "Female" ~ "0"))
dataex1 %>% summary(lm(score ~ factor(Gendering), data = datacool1))
model<- lm(formula= score~Gendering, data= datacool1)
(summary(model))
#for male
malepred <- -1.07*1+4.75
#for female
femalepred <- -1.07*0+4.75
model1<- lm(formula = score~Age, data= datacool1)
summary(model1)
#for 20 year old
twentypred <- 0.015*20+4.01
#for 40 year old
fourtypred <- 0.015*40+4.01
model1<- lm(formula = score~Age+factor(Gendering), data= datacool1)
summary(model1)
cool3 <- lm(score~ Age * factor(Gendering), data = datacool1)
summary(cool3)
#for 20year old man
twentyman <- 0.02*20-1.1*1+4.08
#for 20year old woman
twentywoman <- 0.02*20-1.1*0+4.08
#for 40year old man
fourtyman <- 0.02*40-1.1*1+4.08
#for 40year old woman
fourtywoman <- 0.02*40-1.1*0+4.08
View(gssr2)
quarto_render
quarto_render()
quarto_render()
quarto_render()
quarto_render()
quarto_render()
library(tidyverse)
library(dplyr)
library(readxl)
library(descr)
library(infer)
library(readxl)
exp21 <- read_excel("experiment_2021C(1)copy.xlsx", col_names = FALSE,
skip = 1)
View(exp21)
attempt1 <- exp21 %>%
mutate(condition = case_when(Control_Msg != "" ~ 1,
Norm_Pos_Msg != "" ~ 2,
Norm_Neg_Msg != "" ~ 3,
Emp_Neg_Msg != "" ~ 4,
Emp_Pos_Msg != "" ~ 5),
id = 1:133,
rolnum = 1:133)
library(tidyverse)
library(readxl)
library(gapminder)
hwdata <- read_excel("hw3data.xlsx",
col_names = FALSE, skip = 2)
install.packages("gapminder")
library("gapminder")
gapminder <- gapminder
library(dplyr)
set.seed(5098765)
randomcountry <- sample_n(gapminder, 1)
randomcountry
Denmark <- gapminder %>%
filter(country == "Denmark")
Denmark %>%  ggplot(aes(x = year, y = pop)) + geom_line()
Denmark %>%  ggplot(aes(x=year, y=lifeExp)) + geom_line()
Denmark %>%  ggplot(aes(x=year, y=gdpPercap)) + geom_line()
#Mean Europe 1952
gapminder %>%
filter(continent=="Europe", year == min(year)) %>%
summarise(avg_pop=mean(pop), avg_lifeExp=mean(lifeExp), avg_gdpPCap= mean(gdpPercap))
#Mean World 1952
gapminder %>%
filter(year == min(year)) %>%
summarise(avg_pop=mean(pop), avg_lifeExp=mean(lifeExp), avg_gdpPCap= mean(gdpPercap))
#Mean Europe 2007
gapminder %>%
filter(continent=="Europe", year == max(year)) %>%
summarise(avg_pop=mean(pop), avg_lifeExp=mean(lifeExp), avg_gdpPCap= mean(gdpPercap))
#Mean World 2007
gapminder %>%
filter(year == max(year)) %>%
summarise(avg_pop=mean(pop), avg_lifeExp=mean(lifeExp), avg_gdpPCap= mean(gdpPercap))
#For purposes of answering question 9:
#Mean Denmark 1952
gapminder %>%
filter(country=="Denmark", year == min(year)) %>%
summarise(avg_pop=mean(pop), avg_lifeExp=mean(lifeExp), avg_gdpPCap= mean(gdpPercap))
#Mean Denmark 2007
gapminder %>%
filter(country=="Denmark", year == max(year)) %>%
summarise(avg_pop=mean(pop), avg_lifeExp=mean(lifeExp), avg_gdpPCap= mean(gdpPercap))
#For Denmark (World) population
zscoreWorld<-gapminder%>%
group_by(year) %>%
mutate(avgpop=mean(pop), sdpop=sd(pop))%>%
filter (country == "Denmark") %>%
mutate(zscore=(pop-avgpop)/sdpop) %>%
filter(year==min(year))
zscoreWorld
#For Denmark (Continent) population
zscoreContinent<-gapminder%>%
group_by(year) %>%
filter (continent == "Europe") %>%
mutate(avgpop=mean(pop),sdpop=sd(pop))%>%
filter (country == "Denmark") %>%
mutate(zscore=(pop-avgpop)/sdpop) %>%
filter(year==min(year))
zscoreContinent
#For Denmark (World) Life Expectancy (Is it correct, like the previous ones??)
zscoreWorldLifeExp<-gapminder%>%
group_by(year) %>%
mutate(avglifeExp=mean(lifeExp), sdlifeExp=sd(lifeExp))%>%
filter (country == "Denmark") %>%
mutate(zscore=(lifeExp-avglifeExp)/sdlifeExp) %>%
filter(year==min(year))
zscoreWorldLifeExp
#For Denmark (Continent) Life Expectancy
zscoreContinentLifeExp<-gapminder%>%
group_by(year) %>%
filter (continent == "Europe") %>%
mutate(avglifeExp=mean(lifeExp),sdlifeExp=sd(lifeExp))%>%
filter (country == "Denmark") %>%
mutate(zscore=(lifeExp-avglifeExp)/sdlifeExp) %>%
filter(year==min(year))
zscoreContinentLifeExp
#For Denmark (World) GDP per Capita
zscoreWorldAvGDPpCap<-gapminder%>%
group_by(year) %>%
mutate(avggdpPercap=mean(gdpPercap), sdgdpPercap=sd(gdpPercap))%>%
filter (country == "Denmark") %>%
mutate(zscore=(gdpPercap-avggdpPercap)/sdgdpPercap) %>%
filter(year==min(year))
zscoreWorldAvGDPpCap
#For Denmark (Continent) GDP per Capita
zscoreContinentAvGDPpCap<-gapminder%>%
group_by(year) %>%
filter (continent == "Europe") %>%
mutate(avggdpPercap=mean(gdpPercap),sdgdpPercap=sd(gdpPercap))%>%
filter (country == "Denmark") %>%
mutate(zscore=(gdpPercap-avggdpPercap)/sdgdpPercap) %>%
filter(year==min(year))
zscoreContinentAvGDPpCap
#21 countries outperform Denmark life expectancy
gapminder %>%
filter(year==max(year)) %>%
arrange(desc(lifeExp)) %>%
filter(lifeExp>79)
#99 countries outperform Denmark population
gapminder %>%
filter(year==max(year)) %>%
arrange(desc(pop)) %>%
filter(pop>5468121)
#11 countries outperform Denmark GDP Per Capita
gapminder %>%
filter(year==max(year)) %>%
arrange(desc(gdpPercap)) %>%
filter(gdpPercap>35279)
#Best-performing country in the world in GDP per Capita is Norway, worst is DR Congo
gapminder %>%
filter(year==max(year)) %>%
arrange(desc(gdpPercap))
#Best-performing country in the world in Life Exp is Japan, worst is Swaziland
gapminder %>%
filter(year==max(year)) %>%
arrange(desc(lifeExp))
#Best-performing country in the world in Population is China, worst is Sao Tome and Principe
gapminder %>%
filter(year==max(year)) %>%
arrange(desc(pop))
life_exp1 <- gapminder%>%
filter(year=="1952")
life_exp2 <- gapminder%>%
filter(year=="2007")
life_exp1 %>%
mutate(difference = life_exp2$lifeExp-lifeExp) %>%
arrange(desc(lifeExp)) %>%
filter(difference > 7.61) %>%
#Countries outperformed Denmark in Europe in life expectancy
filter(continent== "Europe")
gdpPercap1 <- gapminder%>%
filter(year=="1952")
gdpPercap2 <- gapminder%>%
filter(year=="2007")
gdpPercap1 %>%
mutate(difference = gdpPercap2$gdpPercap-gdpPercap) %>%
arrange(desc(gdpPercap)) %>%
filter(difference>25587) %>%
#Countries that outperformed Denmark in Europe:
filter(continent=="Europe")
pop1 <- gapminder%>%
filter(year=="1952")
pop2 <- gapminder%>%
filter(year=="2007")
pop1 %>%
mutate(difference = pop2$pop-pop) %>%
arrange(desc(pop)) %>%
filter(difference>1134120) %>%
#Countries that outperformed Denmark in Europe:
filter(continent=="Europe")
gapminder %>%
group_by(year) %>%
filter(continent == "Europe") %>%
mutate(sum=sum(pop)) %>%
select(sum)
gapminder %>%
group_by(year) %>%
mutate(gdp=sum(pop*gdpPercap)) %>%
select(gdp)
gapminder%>% pivot_wider(id_cols = country, names_from = year, values_from = c(pop, lifeExp, gdpPercap))
install.packages("gapminder")
quarto_render()
library(quarto)
quarto_render()
quarto_render()
install.packages("gapminder")
library("gapminder")
gapminder <- gapminder
library(dplyr)
set.seed(5098765)
randomcountry <- sample_n(gapminder, 1)
randomcountry
Denmark <- gapminder %>%
filter(country == "Denmark")
Denmark %>%  ggplot(aes(x = year, y = pop)) + geom_line()
quarto_render()
quarto_render()
quarto_render()
quarto_render()
knitr::opts_chunk$set(echo = TRUE)
titanic <- read.csv("titanic3.csv")
knitr::opts_chunk$set(echo = TRUE)
titanic <- read.csv("titanic3.csv")
table(survived, pclass)
table(survived, pclass)
titanic %>% table(survived, pclass)
table(survived, pclass)
knitr::opts_chunk$set(echo = TRUE)
titanic <- read.csv("titanic3.csv")
table(survived, pclass)
getwd
getwd()
setwd("~/Desktop/github")
setwd("~/Desktop/github/bds522")
knitr::opts_chunk$set(echo = TRUE)
titanic <- read.csv("titanic3.csv")
table(survived, pclass)
setwd("~/Desktop/github/LoizosKo")
knitr::opts_chunk$set(echo = TRUE)
titanic <- read.csv("titanic3.csv")
knitr::opts_chunk$set(echo = TRUE)
titanic <- read.csv("titanic3.csv")
table(survived, pclass)
knitr::opts_chunk$set(echo = TRUE)
titanic <- read.csv("titanic3.csv")
knitr::opts_chunk$set(echo = TRUE)
titanic <- read.csv("titanic3.csv")
table(survived, pclass)
quarto_render()
quarto_render()
quarto_render()
quarto_render()
quarto_render()
quarto_render()
quarto_render()
quarto_render()
quarto_render()
quarto_render()
knitr::opts_chunk$set(echo = TRUE)
titanic <- read.csv("titanic3.csv")
table(survived, pclass)
titanic %>% table(survived, pclass)
table(survived, pclass)
knitr::opts_chunk$set(echo = TRUE)
titanic <- read.csv("titanic3.csv")
table(survived, pclass)
titanic %$% table(survived, pclass)
knitr::opts_chunk$set(echo = TRUE)
titanic <- read.csv("titanic3.csv")
View(zscoreContinentAvGDPpCap)
knitr::opts_chunk$set(echo = TRUE)
titanic <- read.csv("titanic3.csv")
library(magrittr)
titanic %$% table(survived, pclass)
titanic %>% table(.$survived, .$pclass)
knitr::opts_chunk$set(echo = TRUE)
titanic <- read.csv("titanic3.csv")
library(magrittr)
titanic %$% table(survived, pclass)
# magrittr does this --> table(titanic$survived, titanic$pclass)
summary(glm(survived ~ factor(pclass), family = "binomial"))
titanic %$% summary(glm(survived ~ factor(pclass), family = "binomial"))
question2 <- glm(survived ~ factor(pclass), family = "binomial")
titanic %$% summary(glm(survived ~ factor(pclass), family = "binomial"))
question2 <- titanic %$% glm(survived ~ factor(pclass), family = "binomial")
exp(question2$coefficients)
knitr::opts_chunk$set(echo = TRUE)
titanic <- read.csv("titanic3.csv")
library(magrittr)
titanic %$% table(survived, pclass)
# magrittr does this --> table(titanic$survived, titanic$pclass)
titanic %$% summary(glm(survived ~ factor(pclass), family = "binomial"))
question2 <- titanic %$% glm(survived ~ factor(pclass), family = "binomial")
exp(question2$coefficients)
summary(glm(survived~factor(pclass) * factor(sex), family = "binomial", data = titanic))
knitr::opts_chunk$set(echo = TRUE)
titanic <- read.csv("titanic3.csv")
library(magrittr)
titanic %$% table(survived, pclass)
# magrittr does this --> table(titanic$survived, titanic$pclass)
titanic %$% summary(glm(survived ~ factor(pclass), family = "binomial"))
question2 <- titanic %$% glm(survived ~ factor(pclass), family = "binomial")
exp(question2$coefficients)
summary(glm(survived~factor(pclass) * factor(sex), family = "binomial", data = titanic))
quarto_render()
knitr::opts_chunk$set(echo = TRUE)
titanic <- read.csv("titanic3.csv")
library(magrittr)
titanic %$% table(survived, pclass)
# magrittr does this --> table(titanic$survived, titanic$pclass)
titanic %$% summary(glm(survived ~ factor(pclass), family = "binomial"))
question2 <- titanic %$% glm(survived ~ factor(pclass), family = "binomial")
exp(question2$coefficients)
summary(glm(survived~factor(pclass) * factor(sex), family = "binomial", data = titanic))
knitr::opts_chunk$set(echo = TRUE)
titanic <- read.csv("titanic3.csv")
library(magrittr)
titanic %$% table(survived, pclass)
# magrittr does this --> table(titanic$survived, titanic$pclass)
titanic %$% summary(glm(survived ~ factor(pclass), family = "binomial"))
question2 <- titanic %$% glm(survived ~ factor(pclass), family = "binomial")
exp(question2$coefficients)
summary(glm(survived~factor(pclass) * factor(sex), family = "binomial", data = titanic))
summary(glm(survived~factor(pclass) * factor(sex), family = "binomial", data = titanic))
quarto_render()
library(quarto)
quarto_render()
quarto_render()
quarto_render()
quarto_render()
knitr::opts_chunk$set(echo = TRUE)
titanic <- read.csv("titanic3.csv")
knitr::opts_chunk$set(echo = TRUE)
titanic <- read.csv("titanic3.csv")
library(magrittr)
titanic %$% table(survived, pclass)
# magrittr does this --> table(titanic$survived, titanic$pclass)
titanic %$% summary(glm(survived ~ factor(pclass), family = "binomial"))
question2 <- titanic %$% glm(survived ~ factor(pclass), family = "binomial")
exp(question2$coefficients)
summary(glm(survived~factor(pclass) * factor(sex), family = "binomial", data = titanic))
quarto_render()
quarto_render()
quarto_render()
quarto_render()
quarto_render()
rm(zscoreContinent, zscoreContinentAvGDPpCap, zscoreContinentLifeExp, zscoreWorld, zscoreWorldLifeExp, zscoreWorldAvGDPpCap)
rm(titanic, Titanic, ti, tii, question2, randomcountry)
rm(pilpi, pop1, pop2)
d2lcon <- DBI::dbConnect(odbc::odbc(), Driver = "ODBC Driver 17 for SQL Server",
Server = "TACSQLPRD", Database = "D2L", UID = Sys.getenv("d2lid"),
PWD = Sys.getenv("d2lpwd"))
install.packages(odbc)
library(odbc)
install(odbc)
install.packages(odbc)
library(odbc)
install.packages(odbc)
library(odbc)
con <- DBI::dbConnect(odbc::odbc(), Driver = "ODBC Driver 17 for SQL Server",
Server = "PSDB", Database = "REPORTREPOSITORY", UID = Sys.getenv("userid"),
PWD = Sys.getenv("pwd"))
quarto_render()
library(quarto)
quarto_render()
quarto_render()
quarto_render()
quarto_render()
quarto_render()
quarto_render()
quarto_render()
quarto_render()
quarto_render()
quarto_render()
quarto_render()
getwd()
shiny::runGadget(sparklyr::connection_spark_shinyapp(), viewer = .rs.embeddedViewer)
